<mat-toolbar color="primary">
  <h1 class="mat-display-1">RFID Inventory</h1>
</mat-toolbar>

<mat-form-field>
    <input matInput (keyup)="applyFilter($event.target.value)" placeholder="Search: 30143639F8419145BEEF0000">
</mat-form-field>
  

<div class="mat-elevation-z8">
<table mat-table 
       [dataSource]="dataSource" multiTemplateDataRows
       class="mat-elevation-z8">
  <ng-container matColumnDef="{{column}}" *ngFor="let column of columnsToDisplay; let i=index">
    <th mat-header-cell *matHeaderCellDef fxFlex="400px"> {{columnAlias[i]}} </th>
    <td mat-cell *matCellDef="let element" fxFlex="400px"> {{element[column]}} </td>
  </ng-container>

  <!-- Expanded Content Column - The detail row is made up of this one column that spans across all columns -->
  <ng-container matColumnDef="expandedDetail">
    <td mat-cell *matCellDef="let element" >
      <div class="example-element-detail" [@detailExpand]="element.expanded ? 'element.expanded' : 'collapsed' " >
        <div class="example-element-description">
          <div  fxLayoutGap="5px grid"  style="padding:12px">
            <div fxLayout="column" fxFlex=50 fxFlex.lt-lg=50>
              <mat-card class="expand-card-sensor">
                <mat-card-title>Sensors</mat-card-title>
                <mat-card-subtitle>&nbsp;</mat-card-subtitle>
                <mat-card-content>
          
                  <div fxFlex=200 fxFlexFill fxLayoutAlign="center center" *ngIf="loading">
                    <mat-progress-spinner mode="indeterminate"></mat-progress-spinner>
                  </div>
          
                  <mat-list fxFlex=50 [fxShow]="!loading">
                    <mat-list-item *ngFor="let sensorId of sensorIds;let i=index"
                      [ngClass]="{'active': isCurrentLocation(sensorId) === true}">
                      <mat-icon matListIcon *ngIf="isCurrentLocation(sensorId) === true">check_circle_outline</mat-icon>
                      <mat-icon matListIcon *ngIf="isCurrentLocation(sensorId) === false">check_circle</mat-icon>
                      <div fxLayout="row" fxFlexFill fxLayoutAlign="right center">
                        <div fxFlex=100>{{sensorId}}</div>
                        <div fxFlex=30 fxFlexAlign="end end" *ngIf="i==0 && tempRead != ''"
                          style="font-weight: bold;text-align: right;margin-right:30px;">
                          <div fxLayout="row" fxLayoutAlign="center">
                            <img matListAvatar src="../assets/icons8-temperature-48.png" alt="">
                            {{tempRead}}°F
                          </div>
                        </div>
                      </div>
                    </mat-list-item>
                  </mat-list>
                </mat-card-content>
              </mat-card>
            </div>
            <div fxLayout="column" fxFlex=8 fxFlex.lt-lg=10>
              <mat-card class="expand-card-info">
                <mat-card-title>Info</mat-card-title>
                <mat-card-subtitle>&nbsp;</mat-card-subtitle>
                <mat-card-content>
                  <mat-progress-spinner mode="indeterminate" *ngIf="loadingTags"></mat-progress-spinner>
                  <div [fxShow]="!loading" fxLayout="column" fxLayoutGap="12px">
                    <ngx-json-viewer *ngIf="tag" [json]="tag" [expanded]="expanded" (click)="clickedInfo()"></ngx-json-viewer>
                  </div>
                </mat-card-content>
              </mat-card>
            </div>
          </div>
        </div>
      </div>
    </td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="columnsToDisplay; sticky: true"></tr>
  <tr mat-row *matRowDef="let element; columns: columnsToDisplay;"
      class="example-element-row"
      [class.example-expanded-row]="element.expanded"
      (click)="expandedElement = expandedElement === element ? null : element; getTagInfo(element); expandedOrCollapsed(element, expandedElement)">
  </tr>
  <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="example-detail-row"></tr>
</table>
<mat-paginator [pageSizeOptions]="[5, 10, 25, 100]"></mat-paginator>
</div>

<!--
<div fxLayout="row wrap" fxLayoutGap="12px grid"  style="padding:12px">
  <div fxLayout="column" fxFlex=22 fxFlex.lt-lg=50>
    <mat-card>
      <mat-card-title>Tags ({{tagCount}})</mat-card-title>
      <mat-card-subtitle>&nbsp;</mat-card-subtitle>
      <mat-card-content>
        <mat-paginator [length]="inventoryGetTagsResponse.length"
          [pageSize]="10"
          [pageSizeOptions]="[5, 10, 25, 100]"
          (page)="pageEvent = OnPageChange($event)">
        </mat-paginator>
        <div fxLayout="column" fxLayoutGap="12px">
          <mat-nav-list color="primary">
            <mat-list-item *ngFor="let t of pagedList; let i = index"
              [ngClass]="{'active':tag?.epc === t.epc}" (click)="getTagInfo(t)">
              <mat-icon matListIcon>label</mat-icon>
              <p mat-line>{{t.epc}}</p>
              <p mat-line> Last Read: {{t.last_read | date:'short'}} </p>

            </mat-list-item>
          </mat-nav-list>
        </div>
        <br>
      </mat-card-content>
    </mat-card>
  </div>
  <div fxLayout="column" fxFlex=30 fxFlex.lt-lg=50>
    <mat-card>
      <mat-card-title>Sensors</mat-card-title>
      <mat-card-subtitle>&nbsp;</mat-card-subtitle>
      <mat-card-content fxLayout="row wrap">

        <div fxFlex=100 fxFlexFill fxLayoutAlign="center center" *ngIf="loading">
          <mat-progress-spinner mode="indeterminate"></mat-progress-spinner>
        </div>

        <mat-list fxFlex=100 [fxShow]="!loading">
          <mat-list-item *ngFor="let sensorId of sensorIds;let i=index"
            [ngClass]="{'active': isCurrentLocation(sensorId) === true}">
            <mat-icon matListIcon *ngIf="isCurrentLocation(sensorId) === true">check_circle_outline</mat-icon>
            <mat-icon matListIcon *ngIf="isCurrentLocation(sensorId) === false">check_circle</mat-icon>
            <div fxLayout="row" fxFlexFill fxLayoutAlign="center center">
              <div fxFlex=100>{{sensorId}}</div>
              <div fxFlex=20 fxFlexAlign="end end" *ngIf="i==0 && tempRead != ''"
                style="font-weight: bold;text-align: right;margin-right:30px;">
                <div fxLayout="row" fxLayoutAlign="center">
                  <img matListAvatar src="../assets/icons8-temperature-48.png" alt="">
                  {{tempRead}}°F
                </div>
              </div>
            </div>
          </mat-list-item>
        </mat-list>
      </mat-card-content>
    </mat-card>
  </div>

  <div fxLayout="column" fxFlex=40 fxFlex.lt-lg=100>
    <mat-card>
      <mat-card-title>Info</mat-card-title>
      <mat-card-subtitle>&nbsp;</mat-card-subtitle>
      <mat-card-content>
        <mat-progress-spinner mode="indeterminate" *ngIf="loadingTags"></mat-progress-spinner>
        <div [fxShow]="!loading" fxLayout="column" fxLayoutGap="12px">
          <ngx-json-viewer *ngIf="tag" [json]="tag" [expanded]="expanded" (click)="clickedInfo()"></ngx-json-viewer>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div> -->