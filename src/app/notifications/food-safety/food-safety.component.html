<!--/* Apache v2 license
*  Copyright (C) <2019> Intel Corporation
*
*  SPDX-License-Identifier: Apache-2.0
*/ -->
<mat-toolbar color="primary">
  <h1 class="mat-display-1">Notifications</h1>
</mat-toolbar>

<form class="date-block" [formGroup]="filterForm">
  <div fxLayout="row" fxLayoutGap="12px"  style="padding:12px">
    <mat-form-field>
      <input matInput
             placeholder="Sender"
             required
             maxlength="25"
             formControlName="sender" >
      <mat-error *ngIf="filterForm.get('sender').hasError('pattern')">Sender must be alphanumeric. No special characters</mat-error>
      <mat-error *ngIf="filterForm.get('sender').hasError('maxLength')">Cannot be more than 25 characters.</mat-error>
      <mat-error *ngIf="filterForm.get('sender').hasError('required')">Cannot be empty.</mat-error>
    </mat-form-field>

    <mat-form-field>
      <input matInput
             [matDatepicker]="fromDate"
             placeholder="From Date"
             formControlName="fromDate"
             (dateInput)="addEvent()">
      <mat-datepicker-toggle matSuffix [for]="fromDate"></mat-datepicker-toggle>
      <mat-datepicker #fromDate></mat-datepicker>
      <mat-error *ngIf="filterForm.get('fromDate').hasError('DateError')">Must be valid date and format.</mat-error>
    </mat-form-field>

    <mat-form-field>
      <input matInput
             [matDatepicker]="toDate"
             placeholder="To Date"
             formControlName="toDate"
             (dateInput)="addEvent()">
      <mat-datepicker-toggle matSuffix [for]="toDate"></mat-datepicker-toggle>
      <mat-datepicker #toDate></mat-datepicker>
      <mat-error *ngIf="filterForm.get('toDate').hasError('DateError')">Must be valid date and format.</mat-error>
    </mat-form-field>
  </div>
  <button mat-raised-button color="primary" class="aligned-submit-button" (click)="submit()" [disabled]="(filterForm.invalid) " >Submit</button>
</form>

<div class="mat-elevation-z8">
  <mat-table [dataSource]="dataSource" multiTemplateDataRows class="mat-elevation-z8">
    <ng-container matColumnDef="{{column}}" *ngFor="let column of columnsToDisplay; let i=index">
      <mat-header-cell *matHeaderCellDef fxFlex="400px"> {{columnAlias[i]}} </mat-header-cell>
      <mat-cell *matCellDef="let element" fxFlex="400px"> {{element[column]}} </mat-cell>
    </ng-container>

    <!-- Expanded Content Column - The detail row is made up of this one column that spans across all columns -->
    <ng-container matColumnDef="expandedDetail" >
      <mat-cell *matCellDef="let element">
        <div  fxFlex=100 class="example-element-detail" style="overflow: hidden"
              [@detailExpand]="element.expanded ? 'element.expanded' : 'collapsed' ">
          <div fxLayout="column" fxFlex=50 >
            <mat-card fxFlex=100>
              <mat-card-title>Sensors</mat-card-title>
              <mat-card-subtitle>&nbsp;</mat-card-subtitle>
              <mat-card-content>
                <div fxFlexFill fxLayoutAlign="center center" *ngIf="loading">
                  <mat-progress-spinner mode="indeterminate"></mat-progress-spinner>
                </div>
                <mat-list fxFlex=100 [fxShow]="!loading">
                  <mat-list-item *ngFor="let sensorId of rfidInventory.sensorIds;let i=index"
                                 [ngClass]="{'active': rfidInventory.isCurrentLocation(sensorId) === true}">
                    <mat-icon matListIcon *ngIf="rfidInventory.isCurrentLocation(sensorId) === true">check_circle_outline</mat-icon>
                    <mat-icon matListIcon *ngIf="rfidInventory.isCurrentLocation(sensorId) === false">check_circle</mat-icon>
                    <div fxLayout="row" fxFlexFill fxLayoutAlign="right center">
                      <div fxFlex=100>{{sensorId}}</div>
                      <div fxFlex=30 fxFlexAlign="end end" *ngIf="i==0 && rfidInventory.tempRead != ''"
                           style="font-weight: bold;text-align: right;margin-right:30px;">
                        <div fxLayout="row" fxLayoutAlign="center">
                          <img matListAvatar src="../assets/icons8-temperature-48.png" alt="">
                          {{rfidInventory.tempRead}}°F
                        </div>
                      </div>
                    </div>
                  </mat-list-item>
                </mat-list>
              </mat-card-content>
            </mat-card>
          </div>
          <div fxLayout="column" fxFlex=50>
            <mat-card>
              <mat-card-title>Detailed Tag Info</mat-card-title>
              <mat-card-subtitle>&nbsp;</mat-card-subtitle>
              <mat-card-content>
                <div fxLayoutAlign="center center" fxFlexFill *ngIf="loading">
                  <mat-progress-spinner mode="indeterminate"></mat-progress-spinner>
                </div>
              </mat-card-content>
            </mat-card>
          </div>

        </div>
      </mat-cell>
    </ng-container>

    <mat-header-row *matHeaderRowDef="columnsToDisplay; sticky: true"></mat-header-row>
    <mat-row *matRowDef="let element; columns: columnsToDisplay;" class="example-element-row">
    </mat-row>
  </mat-table>
  <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]"></mat-paginator>
</div>
